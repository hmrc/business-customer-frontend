@*
 * Copyright 2025 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config._
@import views.html.helpers._
@import uk.gov.hmrc.govukfrontend.views.Implicits.RichInput
@import views.html.helper.form
@import views.ViewUtils.titleBuilder
@this(
  bcMain:            bcMain,
  formHelper:        FormWithCSRF,
  govukInput:        GovukInput,
  govukDetails:      GovukDetails,
  govukBackLink:     GovukBackLink,
  govukErrorSummary: GovukErrorSummary,
  govukButton:       GovukButton
)
@(form: Form[app.forms.BusinessVerificationForms.SopNameData],
  isAgent:     Boolean,
  service:     String,
  businessType: String,
  backLink:    Option[String]
)(implicit request: Request[_], messages: Messages, appConfig: ApplicationConfig)
@headingText = @{
  if (isAgent) messages("bc.business-verification-selected-agent-header")
  else          messages("bc.business-verification-selected-user-header")
}
@headingSecondaryText = @{
  if (isAgent) messages("bc.business-verification.agent.text", service.toUpperCase)
  else          messages("bc.business-verification.client.text", service.toUpperCase)
}
@backLinkHtml = {
  @backLink.map { href =>
    @govukBackLink(BackLink(href = href, content = Text("Back")))
  }
}
@bcMain(
  title    = titleBuilder(headingText, Some(form)),
  service  = service,
  backlink = Some(backLinkHtml)
) {
  @if(form.errors.nonEmpty) {
    @govukErrorSummary(ErrorSummary().withFormErrorsAsText(form))
  }
  <header>
    <h1 class="govuk-heading-xl">
      <span class="govuk-caption-xl hmrc-caption-xl">
        <span class="govuk-visually-hidden">@messages("bc.screen-reader.section")</span>
        @headingSecondaryText
      </span>
      @headingText
    </h1>
  </header>
  @if(isAgent){
    @bcCheckAgency()
  }
  <p class="govuk-body">@messages("bc.business-verification-lede")</p>
  @formHelper(action = routes.BusinessVerificationController.submitSopName(service)) {
    @govukInput(
      Input(
        name         = "firstName",
        label        = Label(Text(messages("bc.business-verification.label.firstname")), classes = "govuk-label--s"),
        hint         = None,
        autocomplete = Some("given-name")
      ).withFormField(form("firstName"))
    )
    @govukInput(
      Input(
        name         = "lastName",
        label        = Label(Text(messages("bc.business-verification.label.surname")), classes = "govuk-label--s"),
        hint         = None,
        autocomplete = Some("family-name")
      ).withFormField(form("lastName"))
    )
    @govukButton(
      Button(
        content    = Text(messages("bc.business-registration.continue")),
        inputType  = Some("submit"),
        attributes = Map("id" -> "continue")
      )
    )
  }
}